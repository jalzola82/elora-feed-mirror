name: Mirror external RSS to GitHub

on:
  schedule:
    - cron: "*/30 * * * *"   # cada 30 min (UTC)
  workflow_dispatch:         # bot√≥n manual "Run workflow"
  push:
    paths:
      - ".github/workflows/mirror.yml"

permissions:
  contents: write  # necesario para poder hacer commits

jobs:
  mirror:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Fetch RSS
        run: |
          mkdir -p public
          curl -sL "https://jalzola.substack.com/feed" \
            -A "FeedMirror/1.0 (+https://github.com/${{ github.repository }})" \
            -o public/feed.xml

      - name: Commit & Push if changed
        run: |
          git config user.name "feed-bot"
          git config user.email "feed-bot@users.noreply.github.com"
          git add public/feed.xml
          git commit -m "Update feed.xml" || echo "No changes"
          git push
